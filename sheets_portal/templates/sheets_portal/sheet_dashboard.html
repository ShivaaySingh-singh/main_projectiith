{% extends "base.html" %}

{% block content %}
<div style="max-width:900px;margin:30px auto;">
  <h2>Google Sheets</h2>

  <form method="get" style="margin-bottom:12px;display:flex;gap:8px;">
    <input type="text" name="q" value="{{ query }}" placeholder="Search sheet..." style="flex:1;padding:8px;border-radius:6px;border:1px solid #ccc;">
    <button type="submit" style="padding:8px;border-radius:6px;border:none;background:#2e86de;color:white;">Search</button>
  </form>

  <table style="width:100%;border-collapse:collapse;">
    <thead>
      <tr style="text-align:left;border-bottom:2px solid #eee;">
        <th style="padding:10px;">Title</th>
        <th style="padding:10px;width:140px;text-align:center;">Open</th>
      </tr>
    </thead>
    <tbody>
      {% for sheet in sheets %}
        <tr style="border-bottom:1px solid #f1f1f1;">
          <td style="padding:10px;">
            <a href="{{ sheet.sheet_url }}" target="_blank" rel="noopener noreferrer" style="text-decoration:none;color:#222;">
              <strong>{{ sheet.title }}</strong>
            </a>
          </td>
          <td style="padding:10px;text-align:center;">
            <a href="{{ sheet.sheet_url }}" target="_blank" rel="noopener noreferrer" style="padding:6px 10px;border-radius:6px;background:#27ae60;color:#fff;text-decoration:none;">Open Sheet</a>
          </td>
        </tr>
      {% empty %}
        <tr><td colspan="2" style="padding:10px;">No sheets found.</td></tr>
      {% endfor %}
    </tbody>
  </table>
</div>
{% endblock %}
